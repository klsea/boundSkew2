means <- ggplot(d1, aes(names, Mean, fill = names)) + geom_bar(stat='identity') +
geom_errorbar(aes(ymin = Mean-SE, ymax = Mean + SE), width = .2, position=position_dodge(.9)) +
theme_minimal() + theme(legend.position = 'none') + xlab("Strategy") + ylab('Average Rating') +
expand_limits(y=c(1,5)) + geom_vline(aes(xintercept=2.5)) +
annotate("text", x = 1.2, y = 5, label = "General Strategy") +
annotate("text", x = 4.2, y = 5, label = "Information Strategy")
means
means <- ggplot(d1, aes(names, Mean, fill = names)) + geom_bar(stat='identity') +
geom_errorbar(aes(ymin = Mean-SE, ymax = Mean + SE), width = .2, position=position_dodge(.9)) +
theme_minimal() + theme(legend.position = 'none') + xlab("Strategy") + ylab('Average Rating') +
expand_limits(y=c(1,5)) + geom_vline(aes(xintercept=2.5)) +
annotate("text", x = 1.2, y = 5, label = "General Strategies") +
annotate("text", x = 4.2, y = 5, label = "Information Strategies")
gutvmath
gutvmath$statistic
gutvmath$parameter
valvparam
summary(valvparam)
summary(valvparam)[1]
summary(valvparam)[2]
summary(valvparam)[2][1]
summary(valvparam)[2][[1]]
summary(valvparam)[[2]
]
valvparam$Within
valvparam$coefficients
valvparam$ID
valvparam$Intercept
valvparam$ID$coefficients
valvparam$Within$coefficients
summary(valvparam)
summary(gutvmath)
gutvmath
gutvmath
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../05_graph_strategy.R')
ggplot(d0, aes(Age, diffstrategy)) + geom_point() + geom_smooth(method = 'lm', fill = 'blue') +
geom_smooth(method = "lm", formula = y ~ x + I(x^2), aes(color = 'red', fill = 'red'))
ggplot(d0, aes(Age, diffstrategy)) + geom_point() + geom_smooth(method = 'lm', aes(color = 'blue', fill = 'blue')) +
geom_smooth(method = "lm", formula = y ~ x + I(x^2), aes(color = 'red', fill = 'red'))
ggplot(d0, aes(Age, diffstrategy)) + geom_point() + geom_smooth(method = 'lm', aes(color = 'Blue', fill = 'Blue')) +
geom_smooth(method = "lm", formula = y ~ x + I(x^2), aes(color = 'Red', fill = 'Red'))
ggplot(d0, aes(Age, diffstrategy)) + geom_point() + geom_smooth(method = 'lm') +
geom_smooth(method = "lm", formula = y ~ x + I(x^2), aes(color = 'Red', fill = 'Red'))
ggplot(d0, aes(Age, diffstrategy)) + geom_point() + geom_smooth(method = 'lm') +
geom_smooth(method = "lm", formula = y ~ x + I(x^2))
ggplot(d0, aes(Age, diffstrategy)) + geom_point() + geom_smooth(method = 'lm', fill = 'Blue') +
geom_smooth(method = "lm", formula = y ~ x + I(x^2))
ggplot(d0, aes(Age, diffstrategy)) + geom_point() + geom_smooth(method = 'lm', fill = 'Blue') +
geom_smooth(method = "lm", formula = y ~ x + I(x^2), color = 'Red', fill = 'Red')
ggplot(d0, aes(Age, diffstrategy)) + geom_point() + geom_smooth(method = 'lm', fill = 'Blue') +
geom_smooth(method = "lm", formula = y ~ x + I(x^2), color = 'Red', fill = 'Red')
rcorr(d0$Age, d0$diff.strategy)
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
source('../06_graph_affect.R')
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
source('../06_graph_affect.R')
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
source('../06_graph_affect.R')
View(d2)
View(d0)
View(d2)
View(d1)
View(d1)
# statistical tests
d3 <- gather(d1, affect, rating, hap:ha, factor_key=TRUE)
View(d3)
aov(rating ~ affect, + Error(ID), data = d3)
aov(rating ~ affect + Error(ID), data = d3)
affectaov <-aov(rating ~ affect + Error(ID), data = d3)
summary(affectaov)
View(d3)
source('~/github/boundSkew2/07_graph_cognitive.R', echo=TRUE)
View(d1)
rcorr(d1$Age, d1$graph_lit)
rcorr(d1$Age, d1$graph_lit)$
)
rcorr(d1$Age, d1$graph_lit)$r
rcorr(d1$Age, d1$graph_lit)$r[2]
View(d3)
rcorr(d3$Age, d3$Numeracy)$p
rcorr(d3$Age, d3$Numeracy)
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
invest1 <- ggplot(d2, aes(lost_invest)) + geom_histogram(binwidth = .5, stat = "count") +
ggtitle('Have you ever made an investment where you lost some \nor all of the money you invested?')
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
invest2
fraud1
fraud2
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
fraud2
fraud3
# load required packages
library(here)
library(ggplot2)
# load source functions
source(here('scr', 'isolate_skew.R'))
source(here('scr', 'clean_skew.R'))
source(here('scr', 'count_skew.R'))
# load data
dt <- read.csv(here("data", "bound_skew2_data.csv"))
# identify begining and end of
d1 <- isolate_skew(dt, 1, grep('Q173', colnames(dt)):grep('Q27', colnames(dt)))
# investment & fraud
d2 <- data.frame(d1$ID, (d1$Q173 - 2)*-1, d1$Q177, d1[11:14])
# load required packages
library(here)
library(ggplot2)
# load source functions
source(here('scr', 'isolate_skew.R'))
source(here('scr', 'clean_skew.R'))
source(here('scr', 'count_skew.R'))
# load data
dt <- read.csv(here("data", "bound_skew2_data.csv"))
# identify begining and end of
d1 <- isolate_skew(dt, 1, grep('Q173', colnames(dt)):grep('Q27', colnames(dt)))
# identify begining and end of
d1 <- isolate_skew(dt, c(1,2), grep('Q173', colnames(dt)):grep('Q27', colnames(dt)))
# investment & fraud
d2 <- data.frame(d1$ID, d1$Age, (d1$Q173 - 2)*-1, d1$Q177, d1[11:14])
View(d2)
colnames(d2) <- c('ID', 'Age', 'lost_invest', 'why_lost', 'detect_fraud', 'likely_fraud', 'high_pressure', 'avoid_fraud')
# counts
n_lost_invest <- nrow(d2[which(d2$lost_invest == 1),])
n_total <- nrow(d2)
n_fraud <- nrow(d2[which(d2$why_lost == 4),])
real_world_n <- c(n_total, n_fraud, n_lost_invest)
write.csv(real_world_n, here('output', 'real_world2.csv'), row.names = FALSE)
# investment graph
# Have you ever made an investment where you lost some or all of the money you invested?
d2$lost_invest <- factor(d2$lost_invest)
d2$lost_invest <- revalue(d2$lost_invest, c("0"="No", "1"="Yes"))
invest1 <- ggplot(d2, aes(lost_invest)) + geom_histogram(binwidth = .5, stat = "count") +
ggtitle('Have you ever made an investment where you lost some \nor all of the money you invested?')
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
loss_color <- colorize_variable(d2$loss)
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
loss_color <- colorize_variable(d2$loss)
p1 <- ggplot(d2, aes(Age, lost_invest))
p2 <- ggplot(d2, aes(gut, fill = loss_color))
fancy_graph(p1,p2, loss_color, 'Lost Investment')
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
loss_color <- colorize_variable(d2$loss)
p1 <- ggplot(d2, aes(Age, lost_invest))
p2 <- ggplot(d2, aes(gut, fill = loss_color))
fancy_graph(p1,p2, loss_color, 'Lost Investment')
loss_color <- colorize_variable(d2$loss)
p1 <- ggplot(d2, aes(Age, lost_invest))
p2 <- ggplot(d2, aes(lost_invest, fill = loss_color))
fancy_graph(p1,p2, loss_color, 'Lost Investment')
p1
p2
loss_color
ggplot(d2, aes(Age, lost_invest))
View(d2)
loss_color <- colorize_variable(d2$loss)
d2$loss_invest <- as.numeric(d2$loss_invest)
loss_color <- colorize_variable(d2$loss)
d2$loss_invest <- as.numeric(d2$loss_invest)
p1 <- ggplot(d2, aes(Age, lost_invest))
p2 <- ggplot(d2, aes(lost_invest, fill = loss_color))
fancy_graph(p1,p2, loss_color, 'Lost Investment')
levels(d2$loss_invest)
labels(d2$loss_invest)
View(d2)
d2$lost_invest
levels(d2$lost_invest)
d2$lost_invest <- revalue(d2$lost_invest, c("No"="0", "Yes" = "1"))
d2$loss_invest <- as.integer(as.character(d2$lost_invest))
d2$loss_invest <- as.numeric(as.character(d2$lost_invest))
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
source('~/github/boundSkew2/08_graph_real_world.R', echo=TRUE)
source('~/github/boundSkew2/08_graph_real_world.R', echo=TRUE)
brary(here)
library(ggplot2)
# load source functions
source(here('scr', 'isolate_skew.R'))
source(here('scr', 'clean_skew.R'))
source(here('scr', 'count_skew.R'))
source(here('scr', 'colorize_variable.R'))
source(here('scr', 'multiplot.R'))
# set hard-coded variables
# load data
dt <- read.csv(here("data", "bound_skew2_data.csv"))
# identify begining and end of
d1 <- isolate_skew(dt, c(1,2), grep('Q173', colnames(dt)):grep('Q27', colnames(dt)))
# investment & fraud
d2 <- data.frame(d1$ID, d1$Age, (d1$Q173 - 2)*-1, d1$Q177, d1[11:14])
colnames(d2) <- c('ID', 'Age', 'lost_invest', 'why_lost', 'detect_fraud', 'likely_fraud', 'high_pressure', 'avoid_fraud')
# load required packages
library(here)
library(ggplot2)
# load source functions
source(here('scr', 'isolate_skew.R'))
source(here('scr', 'clean_skew.R'))
source(here('scr', 'count_skew.R'))
source(here('scr', 'colorize_variable.R'))
source(here('scr', 'multiplot.R'))
# load data
dt <- read.csv(here("data", "bound_skew2_data.csv"))
# identify begining and end of
d1 <- isolate_skew(dt, c(1,2), grep('Q173', colnames(dt)):grep('Q27', colnames(dt)))
# investment & fraud
d2 <- data.frame(d1$ID, d1$Age, (d1$Q173 - 2)*-1, d1$Q177, d1[11:14])
colnames(d2) <- c('ID', 'Age', 'lost_invest', 'why_lost', 'detect_fraud', 'likely_fraud', 'high_pressure', 'avoid_fraud')
# load required packages
library(here)
library(ggplot2)
# load source functions
source(here('scr', 'isolate_skew.R'))
source(here('scr', 'clean_skew.R'))
source(here('scr', 'count_skew.R'))
source(here('scr', 'colorize_variable.R'))
source(here('scr', 'multiplot.R'))
# load data
dt <- read.csv(here("data", "bound_skew2_data.csv"))
# identify begining and end of
d1 <- isolate_skew(dt, c(1,2), grep('Q173', colnames(dt)):grep('Q27', colnames(dt)))
# investment & fraud
d2 <- data.frame(d1$ID, d1$Age, (d1$Q173 - 2)*-1, d1$Q177, d1[11:14])
colnames(d2) <- c('ID', 'Age', 'lost_invest', 'why_lost', 'detect_fraud', 'likely_fraud', 'high_pressure', 'avoid_fraud')
View(d2)
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
loss_color <- colorize_variable(d2$loss_invest)
#p1 <- ggplot(d2, aes(Age, lost_invest))
#p2 <- ggplot(d2, aes(lost_invest, fill = loss_color))
#fancy_graph(p1,p2, loss_color, 'Lost Investment')
View(d2)
# load required packages
library(here)
library(ggplot2)
# load source functions
source(here('scr', 'isolate_skew.R'))
source(here('scr', 'clean_skew.R'))
source(here('scr', 'count_skew.R'))
source(here('scr', 'colorize_variable.R'))
source(here('scr', 'multiplot.R'))
# load data
dt <- read.csv(here("data", "bound_skew2_data.csv"))
# identify begining and end of
d1 <- isolate_skew(dt, c(1,2), grep('Q173', colnames(dt)):grep('Q27', colnames(dt)))
# investment & fraud
d2 <- data.frame(d1$ID, d1$Age, (d1$Q173 - 2)*-1, d1$Q177, d1[11:14])
colnames(d2) <- c('ID', 'Age', 'lost_invest', 'why_lost', 'detect_fraud', 'likely_fraud', 'high_pressure', 'avoid_fraud')
# counts
n_lost_invest <- nrow(d2[which(d2$lost_invest == 1),])
n_total <- nrow(d2)
n_fraud <- nrow(d2[which(d2$why_lost == 4),])
real_world_n <- c(n_total, n_fraud, n_lost_invest)
write.csv(real_world_n, here('output', 'real_world2.csv'), row.names = FALSE)
library(plyr)
# investment graph
# Have you ever made an investment where you lost some or all of the money you invested?
d2$lost_invest <- factor(d2$lost_invest)
# load required packages
library(here)
library(ggplot2)
# load source functions
source(here('scr', 'isolate_skew.R'))
source(here('scr', 'clean_skew.R'))
source(here('scr', 'count_skew.R'))
source(here('scr', 'colorize_variable.R'))
source(here('scr', 'multiplot.R'))
# load data
dt <- read.csv(here("data", "bound_skew2_data.csv"))
# identify begining and end of
d1 <- isolate_skew(dt, c(1,2), grep('Q173', colnames(dt)):grep('Q27', colnames(dt)))
# investment & fraud
d2 <- data.frame(d1$ID, d1$Age, (d1$Q173 - 2)*-1, d1$Q177, d1[11:14])
# identify begining and end of
d1 <- isolate_skew(dt, c(1,2), grep('Q173', colnames(dt)):grep('Q27', colnames(dt)))
# investment & fraud
d2 <- data.frame(d1$ID, d1$Age, (d1$Q173 - 2)*-1, d1$Q177, d1[11:14])
View(d2)
# investment & fraud
d2 <- data.frame(d1$ID, d1$Age, (d1$Q173 - 2)*-1, d1$Q177, d1[11:14])
colnames(d2) <- c('ID', 'Age', 'lost_invest', 'why_lost', 'detect_fraud', 'likely_fraud', 'high_pressure', 'avoid_fraud')
# investment & fraud
d2 <- data.frame(d1$ID, d1$Age, (d1$Q173 - 2)*-1, d1$Q177, d1[11:14])
# investment & fraud
d2 <- data.frame(d1$ID, d1$Age, (d1$Q173 - 2)*-1, d1$Q177, d1$Q11, d1$Q13, d1$Q15, d1$Q17)
colnames(d2) <- c('ID', 'Age', 'lost_invest', 'why_lost', 'detect_fraud', 'likely_fraud', 'high_pressure', 'avoid_fraud')
# counts
n_lost_invest <- nrow(d2[which(d2$lost_invest == 1),])
n_total <- nrow(d2)
n_fraud <- nrow(d2[which(d2$why_lost == 4),])
real_world_n <- c(n_total, n_fraud, n_lost_invest)
write.csv(real_world_n, here('output', 'real_world2.csv'), row.names = FALSE)
library(plyr)
# investment graph
# Have you ever made an investment where you lost some or all of the money you invested?
d2$lost_invest <- factor(d2$lost_invest)
d2$lost_invest <- revalue(d2$lost_invest, c("0"="No", "1"="Yes"))
invest1 <- ggplot(d2, aes(lost_invest)) + geom_histogram(binwidth = .5, stat = "count") +
ggtitle('Have you ever made an investment where you lost some \nor all of the money you invested?')
# If yes, Which statement below best describes why you lost money?
d2$why_lost <- factor(d2$why_lost)
d2$why_lost <- revalue(d2$why_lost, c('1'='Bad Investment', '2'='Market Downturn',
'3'='Lack of Knowledge', '4'='Misled or Defrauded', '5'='Other'))
invest2 <- ggplot(d2[which(d2$lost_invest=='Yes'),], aes(why_lost, fill = why_lost)) +
geom_histogram(binwidth = .5, stat = "count") +
theme(axis.text.x  = element_text(angle=90, vjust=0.5, size=12)) + guides(fill=FALSE) +
ggtitle('If yes, which statement below best describes why you lost money?') +
theme(axis.title.x = element_blank())
# fraud
## How able are you to detect a fraudulent investment? (select one)
d2$detect_fraud <- factor(d2$detect_fraud)
d2$detect_fraud <- revalue(d2$detect_fraud , c('1' = 'not able to detect', '7' = 'very able to detect'))
fraud1 <- ggplot(d2, aes(detect_fraud)) + geom_histogram(binwidth = .5, stat = "count") +
ggtitle("How able are you to detect a fraudulent investment?") + theme(axis.title.x = element_blank())
# How likely are you to make a fraudulent investment? (select one)
d2$likely_fraud <- factor(d2$likely_fraud)
d2$likely_fraud <- revalue(d2$likely_fraud , c('1' = 'not at all likely', '7' = 'very likely'))
fraud2 <- ggplot(d2, aes(likely_fraud)) + geom_histogram(binwidth = .5, stat = "count") +
ggtitle("How likely are you to make a fraudulent investment?") + theme(axis.title.x = element_blank())
# How able are you to resist high-pressure sales tactics when buying investments? (select one)
d2$high_pressure <- factor(d2$high_pressure)
d2$high_pressure <- revalue(d2$high_pressure , c('1' = 'not at all able to resist', '7' = 'very able to resist'))
fraud3 <- ggplot(d2, aes(high_pressure)) + geom_histogram(binwidth = .5, stat = "count") +
ggtitle("How able are you to resist high-pressure sales tactics \nwhen buying investments?") +
theme(axis.title.x = element_blank())
# Have you ever encountered a situation in which someone was pitching a potentially fraudulent investment, but you avoided investing or losing money?  (select one)
# Have you ever encountered a situation in which someone was pitching a potentially fraudulent investment, but you avoided investing or losing money?  (select one)
#gplot(d2, aes(avoid_fraud)) + geom_histogram(binwidth = .5, stat = "count") - bad question
source('~/github/boundSkew2/08_graph_real_world.R', echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(Hmisc)
source('../08_graph_real_world.R')
detect_color <- colorize_variable(d2$detect_fraud)
p1 <- ggplot(d3, aes(Age, detect_fraud))
#p2 <- ggplot(d2, aes(lost_invest, fill = loss_color))
#fancy_graph(p1,p2, loss_color, 'Lost Investment')
p1
detect_color <- colorize_variable(d2$detect_fraud)
p1 <- ggplot(d3, aes(Age, detect_fraud)) + geom_point()
#p2 <- ggplot(d2, aes(lost_invest, fill = loss_color))
#fancy_graph(p1,p2, loss_color, 'Lost Investment')
p1
detect_color <- colorize_variable(d3$detect_fraud)
p1 <- ggplot(d3, aes(Age, detect_fraud)) + geom_point()
#p2 <- ggplot(d2, aes(lost_invest, fill = loss_color))
#fancy_graph(p1,p2, loss_color, 'Lost Investment')
p1
detect_color <- colorize_variable(d3$detect_fraud)
p1 <- ggplot(d3, aes(Age, detect_fraud)) + geom_point()
p1 <- ggplot(d3, aes(Age, detect_fraud)) + geom_point()
p2 <- ggplot(d3, aes(lost_invest, fill = loss_color))
p2
detect_color <- colorize_variable(d3$detect_fraud)
p1 <- ggplot(d3, aes(Age, detect_fraud)) + geom_point()
p2 <- ggplot(d3, aes(lost_invest, fill = detect_color))
#fancy_graph(p1,p2, loss_color, 'Lost Investment')
p2
detect_color <- colorize_variable(d3$detect_fraud)
p1 <- ggplot(d3, aes(Age, detect_fraud)) + geom_point()
p2 <- ggplot(d3, aes(lost_invest, fill = detect_color))
fancy_graph(p1,p2, detect_color, 'Fraud Investment')
detect_color <- colorize_variable(d3$detect_fraud)
fraud_color <- colorize_variable(d3$detect_fraud)
fraud_color
View(colorize_variable)
fraud_color <- colorize_variable(d3$detect_fraud)
p1 <- ggplot(d3, aes(Age, detect_fraud)) + geom_point()
p2 <- ggplot(d3, aes(lost_invest, fill = fraud_color))
fancy_graph(p1,p2, fraud_color, 'Fraud Investment')
p1
p2
fancy_graph(p1,p2, fraud_color, 'Fraud Investment')
fraud_color <- colorize_variable2(d3$detect_fraud)
p1 <- ggplot(d3, aes(Age, detect_fraud))
p2 <- ggplot(d3, aes(lost_invest, fill = fraud_color))
fancy_graph(p1,p2, fraud_color, 'Fraud Investment')
colorize_variable2 <- function(variable) {
new_variable <- factor(variable)
levels(new_variable)[1] <- 'Not at all'
levels(new_variable)[2] <- '2'
levels(new_variable)[3] <- '3'
levels(new_variable)[4] <- '4'
levels(new_variable)[5] <- '5'
levels(new_variable)[5] <- '6'
levels(new_variable)[5] <- 'Very'
return(new_variable)
}
fraud_color <- colorize_variable2(d3$detect_fraud)
p1 <- ggplot(d3, aes(Age, detect_fraud))
p2 <- ggplot(d3, aes(lost_invest, fill = fraud_color))
fancy_graph(p1,p2, fraud_color, 'Fraud Investment')
plot2 <- p2
g2 <- plot2 + geom_histogram(stat='count') + coord_flip() +
theme_minimal() + theme(legend.position = 'none', axis.title.y = element_blank(),
axis.text.y = element_blank()) + xlab('Count')
g2
plot2 + geom_histogram(stat='count')
detect_color <- colorize_variable(d3$detect_fraud)
p1 <- ggplot(d3, aes(Age, detect_fraud)) + geom_point()
p2 <- ggplot(d3, aes(detect_fraud, fill = detect_color))
fancy_graph(p1,p2, detect_color, 'Fraud Investment')
detect_color <- colorize_variable(d3$detect_fraud)
p1 <- ggplot(d3, aes(Age, detect_fraud)) + geom_point()
p1
p2 <- ggplot(d3, aes(detect_fraud, fill = detect_color))
p2
fancy_graph(p1,p2, detect_color, 'Fraud Investment')
likely_color <- colorize_variable(d3$likely_fraud)
p1 <- ggplot(d3, aes(Age, likely_fraud)) + geom_point()
p2 <- ggplot(d3, aes(likely_fraud, fill = detect_color))
fancy_graph(p1,p2, likely_color, 'Likely to make  Fraud Investment')
likely_color <- colorize_variable(d3$likely_fraud)
p1 <- ggplot(d3, aes(Age, likely_fraud)) + geom_point()
p2 <- ggplot(d3, aes(likely_fraud, fill = likely_color))
fancy_graph(p1,p2, likely_color, 'Likely to make  Fraud Investment')
hp_color <- colorize_variable(d3$high_pressure)
p1 <- ggplot(d3, aes(Age, high_pressure)) + geom_point()
p2 <- ggplot(d3, aes(high_pressure, fill = hp_color))
fancy_graph(p1,p2, hp_color, 'Resist High Pressure Sales')
View(dt)
View(d1)
colorize_variable7 <- function(variable) {
new_variable <- factor(variable)
levels(new_variable)[1] <- 'Yes'
levels(new_variable)[2] <- 'No'
return(new_variable)
}
loss_color <- colorize_variable2(d3$loss_invest)
p1 <- ggplot(d3, aes(Age, lost_invest))
p2 <- ggplot(d3, aes(lost_invest, fill = loss_color))
fancy_graph(p1,p2, loss_color, 'Lost Investment')
source('~/github/boundSkew2/scr/colorize_variable.R', echo=TRUE)
loss_color <- colorize_variable2(d3$loss_invest)
p1 <- ggplot(d3, aes(Age, lost_invest))
p2 <- ggplot(d3, aes(lost_invest, fill = loss_color))
fancy_graph(p1,p2, loss_color, 'Lost Investment')
loss_color <- colorize_variable2(d3$loss_invest)
p1 <- ggplot(d3, aes(Age, lost_invest))
p2 <- ggplot(d3, aes(lost_invest, fill = loss_color))
p1
p2
mean(d3$lost_invest)
p2
loss_color <- colorize_variable2(d3$loss_invest)
colorize_variable2 <- function(variable) {
new_variable <- factor(variable)
levels(new_variable)[1] <- '0'
levels(new_variable)[2] <- '1'
return(new_variable)
}
loss_color <- colorize_variable2(d3$loss_invest)
p1 <- ggplot(d3, aes(Age, lost_invest))
p2 <- ggplot(d3, aes(lost_invest, fill = loss_color))
fancy_graph(p1,p2, loss_color, 'Lost Investment')
plot2 <- p2
g2 <- plot2 + geom_histogram(stat='count') + coord_flip() +
theme_minimal() + theme(legend.position = 'none', axis.title.y = element_blank(),
axis.text.y = element_blank()) + xlab('Count')
plot2 + geom_histogram(stat='count')
p2 <- ggplot(d3, aes(lost_invest, fill = loss_color))
g2 <- plot2 + geom_histogram(stat='count') + coord_flip() +
theme_minimal() + theme(legend.position = 'none', axis.title.y = element_blank(),
axis.text.y = element_blank()) + xlab('Count')
g2
plot2 <- p2
plot2 + geom_histogram(stat='count')
